todo optionReferences
todo fix extend references